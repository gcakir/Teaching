%%%%%%%%%%%%%%%%%%%%%%%%% standard packages

\RequirePackage{currfile}
\RequirePackage{amsmath,amssymb,amsthm}
\RequirePackage[hyphens]{url}
\RequirePackage{paralist}
\RequirePackage{kvoptions}
\usepackage[top=2cm,bottom=2cm,left=2cm,right=2cm]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%% options using kvoptions

\SetupKeyvalOptions{family=ln,prefix=ln@} % needed to override default values obtained from file name
%% the root directory that contains the macros directory
\DeclareStringOption[..]{root}
\ProcessKeyvalOptions*


%%%%%%%%%%%%%%%%%%%%%%%%% my packages

\usepackage{\ln@root/macros/twelf-math}
\usepackage[book,mark]{\ln@root/macros/theorems}
\usepackage{\ln@root/macros/basics}

\usepackage[hyperfootnotes=false,bookmarks=true, linkcolor=blue, citecolor=blue, urlcolor=blue, colorlinks=true, breaklinks=true, bookmarksopen=true,bookmarksopenlevel=1,bookmarksnumbered]{hyperref} % this needs to go last

%%%%%%%%%%%%%%%%%%%%%%%%% formatting

\newenvironment{exsolution}[1]{\textit{Solution} to Ex.~\ref{#1}.}{\medskip}
\markEnv{exsolution}

\setlength{\parindent}{0pt}
\setlength{\parskip}{2pt}

\setcounter{topnumber}{2}
\setcounter{bottomnumber}{2}
\setcounter{totalnumber}{4}     % 2 may work better

\newcommand{\defemph}[1]{{\bf #1}}

\newcommand{\highlightframe}[1]{\noindent\fbox{\parbox{.99\textwidth}{\centering#1}}}

% generate toc entry for the bibliography
\newcommand{\tocentryBib}{
\cleardoublepage
\phantomsection
\addcontentsline{toc}{part}{Bibliography}
}

%%%%%%%%%%%%%%%%%%%%%%%%% logic

\renewcommand{\|}{\,|\,} %% produces || otherwise

\newcommand{\FORM}{\mathtt{form}}
\newcommand{\TERM}{\mathtt{term}}
\newcommand{\VAR}{\mathtt{var}}
\newcommand{\false}{\op{false}}
\newcommand{\true}{\op{true}}
\let\Equiv=\equiv
\renewcommand{\equiv}{\darr}
\newcommand{\arit}{\op{ar}}
\newcommand{\isterm}[4][]{#3\der^{#1}_{#2}#4:\TERM}
\newcommand{\istermS}[2]{\isterm{\Sigma}{#1}{#2}}
\newcommand{\istermSG}[1]{\isterm{\Sigma}{\Gamma}{#1}}
\newcommand{\isform}[4][]{#3\der^{#1}_{#2}#4:\FORM}
\newcommand{\isformS}[2]{\isform{\Sigma}{#1}{#2}}
\newcommand{\isformSG}[1]{\isform{\Sigma}{\Gamma}{#1}}
\newcommand{\sub}[2]{#1/#2}

\newcommand{\gSigma}{{\color{gray}\Sigma}}
\newcommand{\gDelta}{{\color{gray}\Delta}}
\newcommand{\gGamma}{{\color{gray}\Gamma}}
\newcommand{\iscons}[5][]{#3\ifnonempty{#4}{\ifnonempty{#3}{;}#4}\der^{#1}_{#2}#5}   %% \iscons[L]{\Sigma}{\Gamma}{\Theta}{F}
\newcommand{\isconsgSGD}[1]{\iscons{\gSigma}{\gGamma}{\gDelta}{#1}} %% \isconsSGD{F}

\newcommand{\PL}{{\mathcal{PL}}}
\newcommand{\FOL}{{\mathcal{FOL}}}
\newcommand{\SFOL}{{\mathcal{SFOL}}}
\newcommand{\FOLEQ}{{\mathcal{FOLEQ}}}
\newcommand{\STT}{{\mathcal{STT}}}
\newcommand{\HOL}{{\mathcal{HOL}}}
%\newcommand{\SIG}{\mathtt{Sig}}
%\newcommand{\CONT}{\mathtt{Ctx}}
\newcommand{\TYPE}{\mathtt{type}}
\newcommand{\issig}[2][]{\der^{#1} #2}
\newcommand{\ismorph}[4][]{\der^{#1} #4:#2\arr#3}
\newcommand{\iscont}[3][]{\der^{#1}_{#2}#3\;\checkmark}
\newcommand{\issubs}[5][]{\der^{#1}_{#2}#5:#3\arr #4}
\newcommand{\istype}[3][]{\der^{#1}_{#2}#3:\TYPE}
\newcommand{\oftype}[5][]{#3\der^{#1}_{#2}#4\;:\;#5}
\newcommand{\istrue}[3][]{\der^{#1}_{#2}#3}
\newcommand{\isdecl}[4][]{#3\der^{#1}_{#2}#4\;\checkmark}
\newcommand{\lam}[2]{\lambda #1:#2.}
\newcommand{\Boole}{\mathbb{B}}

\newcommand{\PROOF}{\mathtt{proof}}
\newcommand{\LF}{{\mathcal{LF}}}
\newcommand{\KIND}{\mathtt{kind}}
\newcommand{\isdsig}[1]{\der #1}
\newcommand{\isdcont}[2]{\der_{#1}#2}
\newcommand{\isdsubs}[4]{\der_{#1}#4:#2\arr #3}
\newcommand{\isdkind}[4][]{#3\der^{#1}_{#2}#4:\KIND}
\newcommand{\ofdkind}[5][]{#3\der^{#1}_{#2}#4\;:\;#5}
\newcommand{\ofdtype}[5][]{#3\der^{#1}_{#2}#4\;:\;#5}
\newcommand{\isdequal}[5][]{#3\der^{#1}_{#2}#4\;=\;#5}

\newcommand{\evcont}[4][]{\der^{#1}_{#2}#3\;\rewrites\;#4}
\newcommand{\evdec}[5][]{#3\der^{#1}_{#2}#4\;\rewrites\;#5}
\newcommand{\evobj}[5][]{#3\der^{#1}_{#2}#4\;\rewrites\;#5}
%\renewcommand{\P}[2]{\Pi #1:#2.}

\newcommand{\rlname}[1]{\ensuremath{\mathtt{#1}}}
\newcommand{\rnsep}{\;\#\;}
\renewcommand{\dotatend}{.} %% put dot at end of Twelf declarations

\newcommand{\Type}{\mathtt{tp}}
\newcommand{\Term}{\mathtt{tm}}
\newcommand{\Fun}{\mathtt{\longrightarrow}}
\newcommand{\App}[2]{#1@#2}
\newcommand{\Lam}{\mathtt{lam}}

\newcommand{\Forms}{\op{Form}}
\newcommand{\FV}{\op{FV}}
\newcommand{\BV}{\op{BV}}
\renewcommand{\Con}{\op{Con}}

\newcommand{\val}{\der}

\newcommand{\univ}{\TERM}
\newcommand{\sem}[1]{\llbracket #1\rrbracket}
\newcommand{\semm}[2]{\sem{#1}^{#2}}
\newcommand{\semcm}[3]{\sem{#1|#2}^{#3}}
\newcommand{\md}{\models}
\newcommand{\reduce}[2]{#2|_{#1}}

\newcommand{\Thm}{\op{Thm}}
\newcommand{\Thy}{\op{Thy}}
\newcommand{\ModC}{\op{ModC}}
\newcommand{\galois}[1]{{#1}^\ast}
\newcommand{\closure}[1]{{#1}^\bullet}
\newcommand{\sM}{{\cal M}}

\newcommand{\kernel}[1]{\mathrm{ker}\, #1}
\newcommand{\image}[1]{\mathrm{im}\, #1}

\newcommand{\incllog}[2]{{#1}^{#2\harr}}
\newcommand{\theolog}[1]{\Th(#1)}
\newcommand{\found}{\mathcal{F}}

\newcommand{\Clause}{\op{Clauses}}

%\renewcommand{\rul}[3]{\ianc{#2}{#1}{#3}} %% only legacy for old logic notes

\newcommand{\inlineremark}[1]{{\hbox{}\hfill #1}}
\newcommand{\advanced}[1]{{\color{gray}#1}}

%%%%%%%%%%%%%%%%%%%%%%%%% datatypes
\newcommand{\Int}{\mathit{int}}
\newcommand{\Char}{\mathit{char}}
\newcommand{\String}{\mathit{string}}
\newcommand{\Unit}{\mathit{unit}}
\newcommand{\Void}{\mathit{void}}
\newcommand{\Bool}{\mathit{bool}}
\newcommand{\Enum}{\mathit{enum}}
\newcommand{\Float}{\mathit{float}}

%%%%%%%%%%%%%%%%%%%%%%%%% complexity

\newcommand{\incircbin}{\mathpalette\@incircbin}
\newcommand{\@incircbin}[2]{\mathbin{\ooalign{\hidewidth$#1#2$\hidewidth\crcr$#1\bigcirc$}}}
\newcommand{\oequal}{\incircbin{=}}
\newcommand{\oleq}{\incircbin{<}}

\newcommand{\compl}{\mathrm{Steps}}
\newcommand{\Oeq}[2]{#1 \oequal #2}
\newcommand{\Oleq}[2]{#1 \oleq #2}
\newcommand{\Poly}{\mathit{Poly}}
\newcommand{\Exp}{\mathit{Exp}}

% misc. examples

\newcommand{\inj}{\mathit{inj}}
\newcommand{\proj}{\mathit{proj}}

\newcommand{\inv}{\mathit{inv}}
\newcommand{\suc}{\mathit{succ}}
\newcommand{\modulus}{\mathit{modulus}}
\renewcommand{\mod}{\mathrm{mod}}
\newcommand{\modop}{\mathop{\mod}}
\newcommand{\divop}{\mathop{\mathrm{div}}}
\newcommand{\lcm}{\mathrm{lcm}}

%%%%%%%%%%%%%%%%%%%%%%%%%%% type theory

\newcommand{\form}{\mathtt{form}}
